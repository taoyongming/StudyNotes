##### 如何设计更优的分布式锁

数据库实现

zookeeper实现

redis实现

#### 分布式事务

1 XA 规范

2 二阶提交和三阶提交

JTA 是基于 XA 规范实现的一套 Java 事务编程接口，是一种二阶段提交事务。

缺点：

各个资源管理器节点存在阻塞。

可能导致数据不一致。

3 事务补偿机制（TCC）

中间件有 TCC-Transaction。

TCC 分为三个阶段，即 Try、Confirm、Cancel

- Try 阶段：主要尝试执行业务，执行各个服务中的 Try 方法，主要包括预留操作；
- Confirm 阶段：确认 Try 中的各个方法执行成功，然后通过 TM 调用各个服务的 Confirm      方法，这个阶段是提交阶段；
- Cancel 阶段：当在 Try 阶段发现其中一个 Try 方法失败，例如预留资源失败、代码异常等，则会触发      TM 调用各个服务的 Cancel 方法，对全局事务进行回滚，取消执行业务。

缺点：需要编写大量业务性代码，例如Try、Confirm、Cancel 方法；然后，我们还需要为每个方法考虑幂等性。

4 业务无侵入方案——Seata(Fescar)

